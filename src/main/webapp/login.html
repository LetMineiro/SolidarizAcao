<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>Login - SolidarizAção</title>
        <link rel="stylesheet" href="login.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    </head>
    <body>                
        <!--navbar compartilhada-->
        <div id="navbar-container"></div>
        
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        
        <div class="login-container">
            <form class="login-form" action="loginUsuario" method="POST">
                <h2><i class="bi bi-person-circle"></i> Entrar</h2>
                
                <label for="email">E-mail</label>
                <input type="email" id="email" name="email" placeholder="Digite seu e-mail" required>
                
                <label for="senha">Senha</label>
                <input type="password" id="senha" name="senha" placeholder="Digite sua senha" required>
                
                <button type="submit">Entrar</button>
                
                <p class="link-cadastro">
                    Ainda não tem conta?
                    <a href="cadastro.html">Cadastrar</a>
                </p>
            </form>
        </div>
        
        <!-- Carregamento da navbar compartilhada e ativação do comportamento do menu -->
        <script>
            fetch('nav.html')
                    .then(response => response.text())
                    .then(data => {
                        document.getElementById('navbar-container').innerHTML = data;
                
                // Interação dos botões da navbar
                $(".sub-btn").click(function () {
                    $(this).next(".sub-menu").slideToggle();
                });
                
                var menu = document.querySelector(".menu");
                var menuBtn = document.querySelector(".menu-btn");
                var closeBtn = document.querySelector(".close-btn");
                
                if (menuBtn && closeBtn && menu) {
                    menuBtn.addEventListener("click", () => {
                        menu.classList.add("active");
                    });
                    
                    closeBtn.addEventListener("click", () => {
                        menu.classList.remove("active");
                    });
                }
                
                window.addEventListener("scroll", function () {
                    var header = document.querySelector("header");
                    if (header) {
                        header.classList.toggle("sticky", window.scrollY > 0);
                    }
                });
            });
        </script>
        <script>
            //Substitui LOGIN pelo nome do usuário se estiver logado
            fetch("perfil")
                    .then(res => res.ok ? res.json() : Promise.reject())
                    .then(data => {
                        const loginLink = document.getElementById("login-link");
                if (loginLink) {
                    loginLink.textContent = `${data.nome.split(" ")[0].toUpperCase()}`;
                    loginLink.href = "perfil.html";
                }
            })
                    .catch(() => {
                        // Se não estiver logado, mantém o link para login.html
                const loginLink = document.getElementById("login-link");
                if (loginLink) {
                    loginLink.textContent = "LOGIN";
                    loginLink.href = "login.html";
                }
            });
        </script>
        <script>
            const params = new URLSearchParams(window.location.search);
            if (params.get("erro") === "1") {
                alert("Email ou senha inválidos. Tente novamente.");
            }
        </script>
    </body>
</html>


